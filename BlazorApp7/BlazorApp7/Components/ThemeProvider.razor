@ChildContent

@code {
    [Parameter] public RenderFragment? ChildContent { get; set; }

    private string _theme = "system";

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
            // Load the theme from local storage or default to "system"
            _theme = await JsRunTime.InvokeAsync<string>("localStorage.getItem", "blazorapp7-ui-theme") ?? "system";
            await SetTheme(_theme);

            StateHasChanged();
        // if (firstRender)
        // {
        // }
    }

    private async Task SetTheme(string theme)
    {
        _theme = theme;
        await JsRunTime.InvokeVoidAsync("localStorage.setItem", "blazorapp7-ui-theme", theme);
        await JsRunTime.InvokeVoidAsync("setTheme", theme);
    }

    private async Task ToggleTheme()
    {
        if (_theme is "light")
        {
            await SetTheme("dark");
        }
        else if (_theme is "dark")
        {
            await SetTheme("light");
        }
        else
        {
            await SetTheme("system");
        }
    }
}